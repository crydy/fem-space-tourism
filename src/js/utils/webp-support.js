// check the browser for WEBP support,
// create 'webp'/'no-webp' class to HTML
// for use .webp images in css if browser support it

export default function setBrowserWEBPSupportMark() {

    return new Promise((resolve) => {

        function testWebP(callback) {
            let webP = new Image();
            webP.onload = webP.onerror = function () {
                callback(webP.height == 2);
            };
            webP.src = "data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";   
        }
        
        testWebP(function (support) {
            let className = support === true ? 'webp' : 'no-webp';
            document.documentElement.classList.add(className);
            
            resolve(support);
        });
    })
}

// original function, without promise creation

// export default function setBrowserWEBPSupportMark() {

//     function testWebP(callback) {
//         let webP = new Image();
//         webP.onload = webP.onerror = function () {
//             callback(webP.height == 2);
//         };
//         webP.src = "data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";   
//     }
    
//     testWebP(function (support) {
//         let className = support === true ? 'webp' : 'no-webp';
//         document.documentElement.classList.add(className);
//     });
// }